<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>USDJPY Trade Journal</title>

<style>
:root{
  --bg:#0f1220;
  --card:#1b1f3b;
  --row:#20255a;           /* â˜… è¡ŒèƒŒæ™¯ */
  --border:rgba(255,255,255,.12);
  --accent:#4f7cff;
  --text:#e6e8ff;
  --muted:#9aa0d1;
  --win:#4caf50;
  --lose:#f44336;
}

*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
  background:var(--bg);
  color:var(--text);
}

header{
  padding:16px;
  text-align:center;
  font-size:20px;
  font-weight:600;
}

nav{
  display:flex;
  gap:8px;
  padding:8px;
  justify-content:center;
}

nav button{
  flex:1;
  background:linear-gradient(#22286a,#1b1f3b);
  color:var(--text);
  border:none;
  padding:10px;
  border-radius:10px;
  font-size:14px;
}
nav button.active{
  background:linear-gradient(#4f7cff,#375bd6);
  color:white;
}

main{padding:16px}

.card{
  background:linear-gradient(180deg,#1b1f3b,#14183a);
  border-radius:16px;
  padding:14px;
  box-shadow:0 10px 30px rgba(0,0,0,.35);
}

h3{
  margin:12px 0 6px;
  font-size:14px;
  color:var(--muted);
}

/* ===============================
   â˜… ç”»åƒå¯„ã›ï¼šãƒã‚§ãƒƒã‚¯è¡ŒUI
   =============================== */
label{
  display:flex;
  align-items:center;
  gap:12px;
  padding:10px 12px;
  background:var(--row);
  border-bottom:1px solid var(--border);
  font-size:14px;
  cursor:pointer;
}

label:last-of-type{
  border-bottom:none;
}

label input{
  width:18px;
  height:18px;
  flex-shrink:0;
}

label span{
  flex:1;
  line-height:1.4;
}
/* =============================== */

input,select,textarea{
  width:100%;
  padding:10px;
  margin-bottom:10px;
  border-radius:10px;
  border:none;
  background:#121533;
  color:var(--text);
}

textarea{height:60px}

/* â˜… æœªåˆ¤å®šãƒœãƒƒã‚¯ã‚¹ */
.result-box{
  margin:14px 0;
  padding:12px;
  text-align:center;
  border-radius:12px;
  background:rgba(255,255,255,.08);
  font-weight:600;
}

.allow{color:var(--win)}
.deny{color:var(--lose)}

button.primary{
  margin-top:8px;
  width:100%;
  padding:14px;
  background:linear-gradient(#4f7cff,#375bd6);
  border:none;
  border-radius:14px;
  color:white;
  font-size:16px;
}

/* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
@media(max-width:600px){
  nav{flex-direction:column}
}
</style>
</head>

<body>
<header>USDJPY ãƒˆãƒ¬ãƒ¼ãƒ‰ç®¡ç†</header>

<nav>
  <button id="tab-check" class="active">ğŸ§  ãƒã‚§ãƒƒã‚¯</button>
  <button id="tab-calendar">ğŸ“… ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</button>
  <button id="tab-stats">ğŸ“Š é›†è¨ˆ</button>
</nav>

<main>

<section id="check" class="card">

<h3>ã‚¹ãƒ†ãƒƒãƒ—â‘ ã€1æ™‚é–“è¶³ã€‘ï¼ˆå…¨ã¦YESï¼‰</h3>
<label><input type="checkbox" class="h1"><span>åˆå‹•ãŒå‡ºã¦ã„ã‚‹</span></label>
<label><input type="checkbox" class="h1"><span>åˆå‹•ã§ä¼¸ã³ãã£ã¦ã„ãªã„</span></label>
<label><input type="checkbox" class="h1"><span>MAä¹–é›¢ãŒå¤§ãã™ããªã„</span></label>
<label><input type="checkbox" class="h1"><span>é«˜å€¤ãƒ»å®‰å€¤æ´ã¿ã§ãªã„</span></label>
<label><input type="checkbox" class="h1"><span>æŠµæŠ—å¸¯ã©çœŸã‚“ä¸­ã§ãªã„</span></label>
<label><input type="checkbox" class="h1"><span>ã€Œã¾ã ä¼¸ã³ãã†ã€ã¨æ„Ÿã˜ã‚‹å½¢</span></label>

<h3>ã‚¹ãƒ†ãƒƒãƒ—â‘¡ã€4æ™‚é–“è¶³ã€‘ï¼ˆ1ã¤ã§ã‚‚NOã§è¦‹é€ã‚Šï¼‰</h3>
<label><input type="checkbox" class="h4"><span>æ˜ç¢ºãªæ–¹å‘ãŒã‚ã‚‹</span></label>
<label><input type="checkbox" class="h4"><span>é ‚ç‚¹ãƒ»åº•ä»˜è¿‘ã§ãªã„</span></label>
<label><input type="checkbox" class="h4"><span>TRçš„ã«ä½™åŠ›ã‚ã‚Š</span></label>
<label><input type="checkbox" class="h4"><span>å¼·ã„å¦å®šãƒ’ã‚²ãªã—</span></label>
<label><input type="checkbox" class="h4"><span>ãƒœãƒªãƒãƒ³å½¢çŠ¶ãŒ1Hã¨æ•´åˆ</span></label>

<h3>ã‚¹ãƒ†ãƒƒãƒ—â‘¢ã€åŸ·è¡Œè¶³åˆ¤å®šã€‘</h3>
<label><input type="radio" name="exe" value="15"><span>15åˆ†ã‚‚åˆå‹•ã§è‰¯ã„</span></label>
<label><input type="radio" name="exe" value="60"><span>15åˆ†ãŒå¾®å¦™ â†’ 1æ™‚é–“åŸ·è¡Œ</span></label>

<div id="finalResult" class="result-box">æœªåˆ¤å®š</div>

<h3>ãƒˆãƒ¬ãƒ¼ãƒ‰è¨˜éŒ²</h3>
<input type="date" id="date">
<input type="time" id="time">
<select id="side">
  <option value="Buy">è²·ã„</option>
  <option value="Sell">å£²ã‚Š</option>
</select>
<select id="result">
  <option value="win">å‹ã¡</option>
  <option value="lose">è² ã‘</option>
</select>
<input type="number" id="lot" placeholder="ãƒ­ãƒƒãƒˆæ•°">
<input type="number" id="amount" placeholder="æç›Šï¼ˆå††ï¼‰">
<input type="number" id="pips" placeholder="pipsï¼ˆè‡ªå‹•ï¼‰" disabled>
<textarea id="comment" placeholder="ã‚³ãƒ¡ãƒ³ãƒˆ"></textarea>

<button class="primary" onclick="saveTrade()">ä¿å­˜</button>
</section>

</main>
<script>
const trades=JSON.parse(localStorage.getItem('trades')||'[]');

const date=document.getElementById('date');
const time=document.getElementById('time');
const side=document.getElementById('side');
const result=document.getElementById('result');
const lotEl=document.getElementById('lot');
const amountEl=document.getElementById('amount');
const pipsEl=document.getElementById('pips');
const comment=document.getElementById('comment');

document.querySelectorAll('input').forEach(i=>i.onchange=judge);

function judge(){
  const h1=[...document.querySelectorAll('.h1')].every(c=>c.checked);
  const h4=[...document.querySelectorAll('.h4')].every(c=>c.checked);
  const exe=document.querySelector('input[name="exe"]:checked');
  const box=document.getElementById('finalResult');

  if(!h1){ box.innerHTML='âŒ è¦‹é€ã‚Šï¼š1æ™‚é–“è¶³æ¡ä»¶æœªé”'; box.className='result-box deny'; return; }
  if(!h4){ box.innerHTML='âŒ è¦‹é€ã‚Šï¼š4æ™‚é–“è¶³ãŒå¦å®š'; box.className='result-box deny'; return; }
  if(!exe){ box.innerHTML='âš  åŸ·è¡Œè¶³æœªé¸æŠ'; return; }

  box.innerHTML=`âœ… ã‚¨ãƒ³ãƒˆãƒªãƒ¼å¯ï½œåŸ·è¡Œè¶³ï¼š${exe.value}åˆ†`;
  box.className='result-box allow';
}

function saveTrade(){
  const lot=Number(lotEl.value);
  const amt=Number(amountEl.value);
  const pips=amt/(lot*1000);
  pipsEl.value=pips.toFixed(1);

  trades.push({
    date:date.value,
    time:time.value,
    side:side.value,
    result:result.value,
    lot,
    amount:amt,
    pips,
    comment:comment.value
  });
  localStorage.setItem('trades',JSON.stringify(trades));
  alert('ä¿å­˜ã—ã¾ã—ãŸ');
}

let current=new Date();
function changeMonth(diff){
  current.setMonth(current.getMonth()+diff);
  renderCalendar();
}
function renderCalendar(){
  const y=current.getFullYear();
  const m=current.getMonth();
  document.getElementById('currentMonth').textContent=`${y}å¹´ ${m+1}æœˆ`;
  const grid=document.getElementById('calendarGrid');
  grid.innerHTML='';
  let monthSum=0;

  const days=new Date(y,m+1,0).getDate();
  for(let d=1;d<=days;d++){
    const dateStr=`${y}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
    const dayTrades=trades.filter(t=>t.date===dateStr);
    const total=dayTrades.reduce((a,b)=>a+b.amount,0);
    monthSum+=total;

    const cell=document.createElement('div');
    cell.style.padding='6px';
    cell.style.borderRadius='8px';
    cell.style.background='rgba(255,255,255,.05)';
    cell.style.cursor='pointer';
    cell.innerHTML=`<div>${d}</div><div style="font-size:12px">${total||''}</div>`;
    cell.onclick=()=>showDayDetail(dateStr);
    grid.appendChild(cell);
  }
  document.getElementById('monthTotal').textContent=`æœˆåˆè¨ˆï¼š${monthSum.toLocaleString()} å††`;
}

function showDayDetail(date){
  const box=document.getElementById('dayDetail');
  const list=trades.filter(t=>t.date===date);
  if(!list.length){ box.innerHTML=''; return; }

  box.innerHTML=`<h4>${date} å†…è¨³</h4>`+
    list.map((t,i)=>`
      <div style="display:flex;justify-content:space-between;align-items:center">
        <span>${t.time} ${t.side} ${t.amount}</span>
        <button onclick="deleteTrade(${i},'${date}')">å‰Šé™¤</button>
      </div>
    `).join('');
}

function deleteTrade(idx,date){
  const i=trades.findIndex((t,n)=>t.date===date && n>=idx);
  trades.splice(i,1);
  localStorage.setItem('trades',JSON.stringify(trades));
  renderCalendar();
  showDayDetail(date);
}

function switchTab(tabId){
  ['check','calendar','stats'].forEach(id=>{
    document.getElementById(id).style.display='none';
  });
  document.getElementById(tabId).style.display='block';

  document.querySelectorAll('nav button').forEach(b=>b.classList.remove('active'));
  const map={check:'tab-check',calendar:'tab-calendar',stats:'tab-stats'};
  document.getElementById(map[tabId]).classList.add('active');

  if(tabId==='calendar') renderCalendar();
}

document.getElementById('tab-check').onclick=()=>switchTab('check');
document.getElementById('tab-calendar').onclick=()=>switchTab('calendar');
document.getElementById('tab-stats').onclick=()=>switchTab('stats');
</script>

</body>
</html>
