<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Trade Checklist</title>

<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  margin: 0;
  background: #f5f5f7;
  color: #111;
}

header {
  background: #111;
  color: #fff;
  padding: 12px;
  text-align: center;
  font-weight: bold;
}

.tabs {
  display: flex;
  background: #fff;
  border-bottom: 1px solid #ddd;
}

.tab {
  flex: 1;
  padding: 12px;
  text-align: center;
  cursor: pointer;
  font-weight: 600;
  color: #666;
}

.tab.active {
  color: #111;
  border-bottom: 3px solid #007aff;
}

.container {
  padding: 16px;
}

.section {
  display: none;
}

.section.active {
  display: block;
}

h2 {
  font-size: 18px;
  margin-top: 24px;
}

label {
  display: block;
  margin: 8px 0;
}

button {
  margin-top: 20px;
  width: 100%;
  padding: 12px;
  font-size: 16px;
  background: #007aff;
  color: #fff;
  border: none;
  border-radius: 8px;
}

.log-item {
  background: #fff;
  padding: 10px;
  margin-bottom: 10px;
  border-radius: 8px;
  font-size: 14px;
}
</style>
</head>

<body>

<header>トレード管理</header>

<div class="tabs">
  <div class="tab active" onclick="switchTab('check')">チェックシート</div>
  <div class="tab" onclick="switchTab('log')">検証記録</div>
</div>

<div class="container">

<!-- チェックシート -->
<div id="check" class="section active">

<h2>① 1時間足</h2>
<label><input type="checkbox"> 初動が出ている</label>
<label><input type="checkbox"> 伸びきっていない</label>
<label><input type="checkbox"> MA乖離していない</label>
<label><input type="checkbox"> 高値・安値掴みでない</label>
<label><input type="checkbox"> 抵抗帯ど真ん中でない</label>

<h2>② 4時間足</h2>
<label><input type="checkbox"> 明確な方向がある</label>
<label><input type="checkbox"> 波の頂点・底ではない</label>
<label><input type="checkbox"> TR的に余力あり</label>
<label><input type="checkbox"> 強いヒゲ否定なし</label>

<h2>③ 判断</h2>
<label><input type="radio" name="decision"> エントリーOK</label>
<label><input type="radio" name="decision"> 見送り</label>

</div>

<!-- 検証記録 -->
<div id="log" class="section">

<h2>検証記録</h2>

<label>
種別：
<select id="type">
  <option>エントリー</option>
  <option>見送り</option>
</select>
</label>

<label>
結果：
<select id="result">
  <option>勝ち</option>
  <option>負け</option>
</select>
</label>

<label>
執行足：
<select id="timeframe">
  <option>15分</option>
  <option>1時間</option>
</select>
</label>

<label>
ロット：
<input id="lot" type="number" step="0.01">
</label>

<label>
損益金額：
<input id="pnl" type="number">
</label>

<h2>ミス・見送り理由</h2>
<label><input type="checkbox"> 初動でない</label>
<label><input type="checkbox"> 伸びきった足</label>
<label><input type="checkbox"> MA乖離</label>
<label><input type="checkbox"> レンジ</label>
<label><input type="checkbox"> 抵抗帯真正面</label>
<label><input type="checkbox"> 感情トレード</label>

<button id="saveTrade">記録する</button>

<h2>記録一覧</h2>
<div id="logList"></div>

</div>
</div>

<script>
function switchTab(tab) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));

  if (tab === 'check') {
    document.querySelectorAll('.tab')[0].classList.add('active');
    document.getElementById('check').classList.add('active');
  } else {
    document.querySelectorAll('.tab')[1].classList.add('active');
    document.getElementById('log').classList.add('active');
  }
}

function renderLogs() {
  const list = document.getElementById('logList');
  const data = JSON.parse(localStorage.getItem('tradeLogs') || '[]');
  list.innerHTML = '';

  data.slice().reverse().forEach(log => {
    const div = document.createElement('div');
    div.className = 'log-item';
    div.innerHTML = `
      <strong>${log.date}</strong><br>
      ${log.type}｜${log.result}｜${log.timeframe}<br>
      Lot:${log.lot} ｜ PnL:${log.pnl}<br>
      ${log.reasons.join(' / ')}
    `;
    list.appendChild(div);
  });
}

document.getElementById('saveTrade').addEventListener('click', function () {
  const record = {
    date: new Date().toISOString().slice(0,10),
    type: document.getElementById('type').value,
    result: document.getElementById('result').value,
    timeframe: document.getElementById('timeframe').value,
    lot: document.getElementById('lot').value,
    pnl: document.getElementById('pnl').value,
    reasons: Array.from(
      document.querySelectorAll('#log input[type="checkbox"]:checked')
    ).map(cb => cb.parentElement.innerText.trim())
  };

  const data = JSON.parse(localStorage.getItem('tradeLogs') || '[]');
  data.push(record);
  localStorage.setItem('tradeLogs', JSON.stringify(data));

  renderLogs();
  alert('保存しました');
});

renderLogs();
</script>

</body>
</html>
