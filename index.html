<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>USDJPY Trade Journal</title>

<style>
:root{
  --bg:#0f1220;
  --card:#1b1f3b;
  --accent:#4f7cff;
  --text:#e6e8ff;
  --muted:#9aa0d1;
  --win:#4caf50;
  --lose:#f44336;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
  background:var(--bg);
  color:var(--text);
}
header{
  padding:16px;
  text-align:center;
  font-size:20px;
  font-weight:600;
}
nav{
  display:flex;
  gap:8px;
  padding:8px;
  justify-content:center;
  flex-wrap:wrap;
}
nav button{
  background:var(--card);
  color:var(--text);
  border:none;
  padding:8px 14px;
  border-radius:10px;
  cursor:pointer;
}
nav button.active{background:var(--accent)}
main{padding:16px}
.card{
  background:var(--card);
  border-radius:14px;
  padding:16px;
  margin-bottom:16px;
  box-shadow:0 10px 30px rgba(0,0,0,.3);
}
h3,h4{margin:8px 0}
label{display:block;margin:6px 0;font-size:14px}
input,select,textarea{
  width:100%;
  padding:8px;
  margin-bottom:8px;
  border-radius:8px;
  border:none;
}
textarea{height:60px}
button.primary{
  width:100%;
  padding:10px;
  background:var(--accent);
  border:none;
  border-radius:10px;
  color:white;
  font-size:16px;
}
.result-box{
  margin:12px 0;
  padding:10px;
  border-radius:10px;
  background:rgba(255,255,255,.05);
  font-weight:600;
}
.allow{color:var(--win)}
.deny{color:var(--lose)}

<!-- STEP 3 ADD -->
#calendarGrid div{
  transition:.2s;
}
#calendarGrid div:hover{
  transform:scale(1.05);
}
#calendarGrid div div:last-child{
  color:var(--muted);
}

</style>
</head>

<body>
<header>USDJPY ãƒˆãƒ¬ãƒ¼ãƒ‰ç®¡ç†</header>

<nav>
  <button id="tab-check" class="active">ğŸ§  ãƒã‚§ãƒƒã‚¯</button>
  <button id="tab-calendar">ğŸ“… ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</button>
  <button id="tab-stats">ğŸ“Š é›†è¨ˆ</button>
</nav>

<main>

<section id="check" class="card">

<h3>ã‚¹ãƒ†ãƒƒãƒ—â‘ ã€1æ™‚é–“è¶³ã€‘ï¼ˆå…¨ã¦YESï¼‰</h3>
<label><input type="checkbox" class="h1"> åˆå‹•ãŒå‡ºã¦ã„ã‚‹</label>
<label><input type="checkbox" class="h1"> åˆå‹•ã§ä¼¸ã³ãã£ã¦ã„ãªã„</label>
<label><input type="checkbox" class="h1"> MAä¹–é›¢ãŒå¤§ãã™ããªã„</label>
<label><input type="checkbox" class="h1"> é«˜å€¤ãƒ»å®‰å€¤æ´ã¿ã§ãªã„</label>
<label><input type="checkbox" class="h1"> æŠµæŠ—å¸¯ã©çœŸã‚“ä¸­ã§ãªã„</label>
<label><input type="checkbox" class="h1"> ã€Œã¾ã ä¼¸ã³ãã†ã€ã¨æ„Ÿã˜ã‚‹å½¢</label>

<h3>ã‚¹ãƒ†ãƒƒãƒ—â‘¡ã€4æ™‚é–“è¶³ã€‘ï¼ˆ1ã¤ã§ã‚‚NOã§è¦‹é€ã‚Šï¼‰</h3>
<label><input type="checkbox" class="h4"> æ˜ç¢ºãªæ–¹å‘ãŒã‚ã‚‹</label>
<label><input type="checkbox" class="h4"> é ‚ç‚¹ãƒ»åº•ä»˜è¿‘ã§ãªã„</label>
<label><input type="checkbox" class="h4"> TRçš„ã«ä½™åŠ›ã‚ã‚Š</label>
<label><input type="checkbox" class="h4"> å¼·ã„å¦å®šãƒ’ã‚²ãªã—</label>
<label><input type="checkbox" class="h4"> ãƒœãƒªãƒãƒ³å½¢çŠ¶ãŒ1Hã¨æ•´åˆ</label>

<h3>ã‚¹ãƒ†ãƒƒãƒ—â‘¢ã€åŸ·è¡Œè¶³åˆ¤å®šã€‘</h3>
<label><input type="radio" name="exe" value="15"> 15åˆ†ã‚‚åˆå‹•ã§è‰¯ã„</label>
<label><input type="radio" name="exe" value="60"> 15åˆ†ãŒå¾®å¦™ â†’ 1æ™‚é–“åŸ·è¡Œ</label>

<div id="finalResult" class="result-box">æœªåˆ¤å®š</div>

<hr style="opacity:.2">

<h3>ãƒˆãƒ¬ãƒ¼ãƒ‰è¨˜éŒ²</h3>
<input type="date" id="date">
<input type="time" id="time">
<select id="side">
  <option value="Buy">è²·ã„</option>
  <option value="Sell">å£²ã‚Š</option>
</select>
<select id="result">
  <option value="win">å‹ã¡</option>
  <option value="lose">è² ã‘</option>
</select>
<input type="number" id="lot" placeholder="ãƒ­ãƒƒãƒˆæ•°">
<input type="number" id="amount" placeholder="æç›Šï¼ˆå††ï¼‰">
<input type="number" id="pips" placeholder="pipsï¼ˆè‡ªå‹•ï¼‰" disabled>
<textarea id="comment" placeholder="ã‚³ãƒ¡ãƒ³ãƒˆ"></textarea>

<button class="primary" onclick="saveTrade()">ä¿å­˜</button>

</section>

<section id="calendar" class="card" style="display:none">
  <!-- STEP 1 ADD : Calendar Header -->
<div id="calendarHeader" style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
  <button onclick="changeMonth(-1)">â†</button>
  <div id="currentMonth"></div>
  <button onclick="changeMonth(1)">â†’</button>
</div>

<!-- STEP 1 ADD : Month Total -->
<div id="monthTotal" style="margin-bottom:10px;font-weight:600"></div>

<!-- STEP 1 ADD : Calendar Grid -->
<div id="calendarGrid" style="display:grid;grid-template-columns:repeat(7,1fr);gap:6px"></div>

<!-- STEP 1 ADD : Day Detail -->
<div id="dayDetail" style="margin-top:14px"></div>
</section>

  <section id="stats" class="card" style="display:none">
    <!-- STEP 2 ADD : Stats Content -->
<div id="statsContent"></div>
  </section>

</main>

<script>
const trades=JSON.parse(localStorage.getItem('trades')||'[]');

document.querySelectorAll('input').forEach(i=>i.onchange=judge);

function judge(){
  const h1=[...document.querySelectorAll('.h1')].every(c=>c.checked);
  const h4=[...document.querySelectorAll('.h4')].every(c=>c.checked);
  const exe=document.querySelector('input[name="exe"]:checked');
  const box=document.getElementById('finalResult');

  if(!h1){ box.innerHTML='âŒ è¦‹é€ã‚Šï¼š1æ™‚é–“è¶³æ¡ä»¶æœªé”'; box.className='result-box deny'; return; }
  if(!h4){ box.innerHTML='âŒ è¦‹é€ã‚Šï¼š4æ™‚é–“è¶³ãŒå¦å®š'; box.className='result-box deny'; return; }
  if(!exe){ box.innerHTML='âš  åŸ·è¡Œè¶³æœªé¸æŠ'; return; }

  box.innerHTML=`âœ… ã‚¨ãƒ³ãƒˆãƒªãƒ¼å¯ï½œåŸ·è¡Œè¶³ï¼š${exe.value}åˆ†`;
  box.className='result-box allow';
}

function saveTrade(){
  const lot=Number(lotEl.value);
  const amt=Number(amountEl.value);
  const pips=amt/(lot*1000);
  pipsEl.value=pips.toFixed(1);

  trades.push({
    date:date.value,
    time:time.value,
    side:side.value,
    result:result.value,
    lot,
    amount:amt,
    pips,
    comment:comment.value
  });
  localStorage.setItem('trades',JSON.stringify(trades));
  alert('ä¿å­˜ã—ã¾ã—ãŸ');
}

const date=document.getElementById('date');
const time=document.getElementById('time');
const side=document.getElementById('side');
const result=document.getElementById('result');
const lotEl=document.getElementById('lot');
const amountEl=document.getElementById('amount');
const pipsEl=document.getElementById('pips');
const comment=document.getElementById('comment');

<!-- STEP 1 ADD : Calendar Logic -->
let current = new Date();

function changeMonth(diff){
  current.setMonth(current.getMonth()+diff);
  renderCalendar();
}

function renderCalendar(){
  const y=current.getFullYear();
  const m=current.getMonth();
  document.getElementById('currentMonth').textContent=`${y}å¹´ ${m+1}æœˆ`;

  const grid=document.getElementById('calendarGrid');
  grid.innerHTML='';
  let monthSum=0;

  const days=new Date(y,m+1,0).getDate();
  for(let d=1;d<=days;d++){
    const dateStr=`${y}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
    const dayTrades=trades.filter(t=>t.date===dateStr);
    const total=dayTrades.reduce((a,b)=>a+b.amount,0);
    monthSum+=total;

    const cell=document.createElement('div');
    cell.style.padding='6px';
    cell.style.borderRadius='8px';
    cell.style.background='rgba(255,255,255,.05)';
    cell.style.cursor='pointer';
    cell.innerHTML=`<div>${d}</div><div style="font-size:12px">${total||''}</div>`;
    cell.onclick=()=>showDayDetail(dateStr);
    grid.appendChild(cell);
  }

  document.getElementById('monthTotal').textContent=`æœˆåˆè¨ˆï¼š${monthSum.toLocaleString()} å††`;
}

function showDayDetail(date){
  const box=document.getElementById('dayDetail');
  const list=trades.filter(t=>t.date===date);
  if(!list.length){ box.innerHTML=''; return; }

  box.innerHTML=`<h4>${date} å†…è¨³</h4>`+
    list.map((t,i)=>`
      <div style="display:flex;justify-content:space-between;align-items:center">
        <span>${t.time} ${t.side} ${t.amount}</span>
        <button onclick="deleteTrade(${i},'${date}')">å‰Šé™¤</button>
      </div>
    `).join('');
}

function deleteTrade(idx,date){
  const i=trades.findIndex((t,n)=>t.date===date && n>=idx);
  trades.splice(i,1);
  localStorage.setItem('trades',JSON.stringify(trades));
  renderCalendar();
  showDayDetail(date);
}

document.getElementById('tab-calendar').onclick=()=>{
  document.getElementById('check').style.display='none';
  document.getElementById('stats').style.display='none';
  document.getElementById('calendar').style.display='block';
  renderCalendar();
};


<!-- STEP 2 ADD : Stats Logic -->
document.getElementById('tab-stats').onclick=()=>{
  document.getElementById('check').style.display='none';
  document.getElementById('calendar').style.display='none';
  document.getElementById('stats').style.display='block';
  renderStats();
};

function renderStats(){
  if(!trades.length){
    statsContent.innerHTML='ãƒ‡ãƒ¼ã‚¿ãªã—';
    return;
  }
  const wins=trades.filter(t=>t.result==='win').length;
  const total=trades.length;
  const winRate=((wins/total)*100).toFixed(1);
  const avgPips=(trades.reduce((a,b)=>a+b.pips,0)/total).toFixed(1);
  const monthSum=trades.reduce((a,b)=>a+b.amount,0);

  statsContent.innerHTML=`
    <div>ãƒˆãƒ¬ãƒ¼ãƒ‰æ•°ï¼š${total}</div>
    <div>å‹ç‡ï¼š${winRate}%</div>
    <div>å¹³å‡pipsï¼š${avgPips}</div>
    <div>ç´¯è¨ˆæç›Šï¼š${monthSum.toLocaleString()} å††</div>
  `;
}

</script>
</body>
</html>

